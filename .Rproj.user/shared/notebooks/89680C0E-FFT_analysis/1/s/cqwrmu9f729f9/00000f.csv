"0","dat2plot <- DataIn %>%"
"0","  dplyr::select(., -RDK_id,-RDK_pos2,-RDK_col1, -RDK_col2, -RDK_freq,-RDK_elec, -condition)%>%"
"0","  group_by(subjects, RDK_pos1, time, condition2)%>%"
"0","  summarise(amplitude_induced=mean(amplitude_induced), amplitude_evoked=mean(amplitude_evoked), "
"0","            modulation_induced=mean(modulation_induced), modulation_evoked=mean(modulation_evoked))%>%"
"0","  ungroup()%>%"
"0","  pivot_longer(c(-subjects, -condition2, -time, -RDK_pos1),names_to = ""signal"", values_to = ""amplitude"")%>%"
"0","  pivot_wider(names_from = ""time"", values_from = ""amplitude"")%>%"
"0","  rename(pre =`[-1 0] `, condition = condition2)%>%"
"0","  rowwise()%>%"
"0","  # mutate(post = mean(c(`[0.5 1.5] `,`[1 2] `))) %>%"
"0","  # mutate(post_diff = mean(c(`[0.5 1.5] `,`[1 2] `)) - pre)%>%"
"0","  mutate(post = mean(c(`[0.5 1.5] `))) %>%"
"0","  mutate(post_diff = mean(c(`[0.5 1.5] `)) - pre)%>%"
"0","  dplyr::select(., subjects, condition, RDK_pos1, pre, post, post_diff, signal)%>%"
"0","  pivot_longer(c(-subjects, -condition,-RDK_pos1, -signal),names_to = ""time"", values_to = ""amplitude"")%>%"
"0","  pivot_wider(names_from = ""signal"", values_from = ""amplitude"")%>%"
"0","  mutate(condition = factor(condition, levels=c('attended','unattended'), ordered = T))%>%"
"0","  mutate(time = factor(time, levels=c('pre','post','post_diff'), ordered = T))"
"2","`summarise()` has grouped output by 'subjects', 'RDK_pos1', 'time'. You can override using the `.groups` argument.
"
"0","#find ylims"
"0","temp_ylims <- dat2plot%>%"
"0","  filter(time==""post"")%>%"
"0","  summarise("
"0","    min = min(modulation_evoked) - (max(modulation_evoked)-min(modulation_evoked))*.04,"
"0","    max = max(modulation_evoked)+ (max(modulation_evoked)-min(modulation_evoked))*.04)"
"0",""
"0","#evoked baseline corrected####"
"0","dat2plot2 <- dat2plot%>%"
"0","  filter(time==""post"")%>%"
"0","  filter(RDK_pos1==""central"")"
"0",""
"0","plot1 <- ggplot(dat2plot2, aes(x = condition, y = modulation_evoked, fill = condition)) +"
"0","  geom_hline(yintercept=0, show.legend = FALSE) +"
"0","  geom_line(aes(group = interaction(subjects,time)),colour = ""grey60"",alpha = 0.4,size =1) +"
"0","  geom_beeswarm(aes(color = condition, x = condition,"
"0","                    group = condition), cex=2.5, size = 5,alpha=0.4,fill=""grey40"",shape=21)+"
"0","  # geom_point(aes(color = condition, x = interaction(time,condition),"
"0","  #                   group = condition), size = 4,alpha=0.4)+"
"0","  stat_summary(fun.y=mean, aes(ymin=..y.., ymax=..y.., color =condition), geom='errorbar', width=0.9, size=1.5) +"
"0","  scale_x_discrete(""condition"", breaks=waiver(), labels = rep(c(""""),1,3)) +"
"0","  # theme(legend.position=""bottom"") +"
"0","  ylab(expression(paste(""amplitude modulation in %"")))+"
"0","  # labs(title=sprintf(""SSVEP modulation | evoked""),"
"0","  #      subtitle=""collapsed across frequencies"")+"
"0","  scale_fill_manual(values=c(""#F1831A"", ""#293C4A"", ""#198A83""))+"
"0","  # scale_fill_brewer(palette = ""Dark2"")+"
"0","  scale_color_manual(values=c(""#F1831A"", ""#293C4A"", ""#198A83""))+"
"0","  # scale_color_brewer(palette = ""Dark2"")+"
"0","  theme(legend.position=""none"")+"
"0","  # scale_y_continuous(limits=c(-60, 140))"
"0","  scale_y_continuous(limits=c(temp_ylims$min, temp_ylims$max))"
"0",""
"0",""
"0","plot2 <- ggplot(dat2plot2, aes(y = modulation_evoked, fill = condition, x = 1)) +"
"0","  geom_flat_violin(aes(fill = condition),position = position_nudge(x = .1, y = 0), adjust = 1.3, trim = FALSE, alpha = .5, colour = NA)+"
"0","  scale_fill_manual(values=c(""#F1831A"", ""#293C4A"", ""#198A83""))+"
"0","  # scale_fill_brewer(palette = ""Dark2"")+"
"0","  scale_color_manual(values=c(""#F1831A"", ""#293C4A"", ""#198A83""))+"
"0","  # scale_color_brewer(palette = ""Dark2"")+"
"0","  theme(axis.title.y=element_blank(),"
"0","        axis.text.y=element_blank(),"
"0","        axis.ticks.y=element_blank())+"
"0","  theme(axis.title.x=element_blank(),"
"0","        axis.text.x=element_blank(),"
"0","        axis.ticks.x=element_blank())+"
"0","  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+"
"0","  # scale_y_continuous(limits=c(-60, 140))"
"0","  scale_y_continuous(limits=c(temp_ylims$min, temp_ylims$max))"
"0",""
"0",""
"0","dat2plot3 <- dat2plot%>%"
"0","  filter(time==""post"")%>%"
"0","  filter(RDK_pos1==""peripheral"")"
"0",""
"0","plot3 <- ggplot(dat2plot3, aes(x = condition, y = modulation_evoked, fill = condition)) +"
"0","  geom_hline(yintercept=0, show.legend = FALSE) +"
"0","  geom_line(aes(group = interaction(subjects,time)),colour = ""grey60"",alpha = 0.4,size =1) +"
"0","  geom_beeswarm(aes(color = condition, x = condition,"
"0","                    group = condition), cex=2.5, size = 5,alpha=0.4,fill=""grey40"",shape=21)+"
"0","  # geom_point(aes(color = condition, x = interaction(time,condition),"
"0","  #                   group = condition), size = 4,alpha=0.4)+"
"0","  stat_summary(fun.y=mean, aes(ymin=..y.., ymax=..y.., color =condition), geom='errorbar', width=0.9, size=1.5) +"
"0","  scale_x_discrete(""condition"", breaks=waiver(), labels = rep(c(""""),1,3)) +"
"0","  # theme(legend.position=""bottom"") +"
"0","  ylab(expression(paste(""amplitude modulation in %"")))+"
"0","  # labs(title=sprintf(""SSVEP modulation | evoked""),"
"0","  #      subtitle=""collapsed across frequencies"")+"
"0","  scale_fill_manual(values=c(""#F1831A"", ""#293C4A"", ""#198A83""))+"
"0","  # scale_fill_brewer(palette = ""Dark2"")+"
"0","  scale_color_manual(values=c(""#F1831A"", ""#293C4A"", ""#198A83""))+"
"0","  # scale_color_brewer(palette = ""Dark2"")+"
"0","  theme(legend.position=""none"")+"
"0","  # scale_y_continuous(limits=c(-60, 140))"
"0","  scale_y_continuous(limits=c(temp_ylims$min, temp_ylims$max))"
"0",""
"0","plot4 <- ggplot(dat2plot3, aes(y = modulation_evoked, fill = condition, x = 1)) +"
"0","  geom_flat_violin(aes(fill = condition),position = position_nudge(x = .1, y = 0), adjust = 1.3, trim = FALSE, alpha = .5, colour = NA)+"
"0","  scale_fill_manual(values=c(""#F1831A"", ""#293C4A"", ""#198A83""))+"
"0","  # scale_fill_brewer(palette = ""Dark2"")+"
"0","  scale_color_manual(values=c(""#F1831A"", ""#293C4A"", ""#198A83""))+"
"0","  # scale_color_brewer(palette = ""Dark2"")+"
"0","  theme(axis.title.y=element_blank(),"
"0","        axis.text.y=element_blank(),"
"0","        axis.ticks.y=element_blank())+"
"0","  theme(axis.title.x=element_blank(),"
"0","        axis.text.x=element_blank(),"
"0","        axis.ticks.x=element_blank())+"
"0","  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+"
"0","  # scale_y_continuous(limits=c(-60, 140))"
"0","  scale_y_continuous(limits=c(temp_ylims$min, temp_ylims$max))"
"0",""
"0",""
"0",""
"0","# cowplot::plot_grid(plot1, plot2, plot3, ncol = 3,labels = ""AUTO"")"
"0","plottitle <- ggdraw() + draw_label(""SSVEP modulation | evoked"", fontface='bold')"
"0",""
"0","plottitle1 <- ggdraw() + draw_label(""central"", fontface='bold')"
"0","plottitle2 <- ggdraw() + draw_label(""peripheral"", fontface='bold')"
"0","plottitle1_2 <- ggarrange(plottitle1, plottitle2, ncol = 2)"
"0",""
"0","plotplots <- ggarrange(plot1, plot2, plot3, plot4, ncol = 4,common.legend = TRUE,align = ""h"", widths=c(3,1,3,1))"
"0",""
"0",""
"0","ggarrange(plottitle, plottitle1_2, plotplots, nrow = 3, heights=c(0.1,0.1, 1))"

"0","dat_plot <- DATA.In_long %>%"
"0","  filter(trial_timing_type == 1) %>%"
"0","  dplyr::select(subject, trialnumber, cue_validity_label, post_event_pos_label, post_hit, post_RT) %>%"
"0","  group_by(subject, cue_validity_label, post_event_pos_label, post_hit) %>% "
"0","  summarise(n_resp= n(), mean_RT = mean(post_RT)) %>%"
"0","  ungroup()%>%"
"0","  group_by(subject, cue_validity_label, post_event_pos_label) %>%"
"0","  mutate(n_cons = sum(n_resp), rate_perc = (n_resp/n_cons)*100) %>%"
"0","  mutate(post_hit = ifelse(post_hit==""NaN"",""miss"",ifelse(post_hit==""0"",""error"",""hit"")))%>%"
"0","  filter(post_hit == ""hit"")%>%"
"0","  select(subject,validity=cue_validity_label,side=post_event_pos_label, post_hit, mean_RT, percent_correct = rate_perc, n_resp, n_cons)"
"2","`summarise()` has grouped output by 'subject', 'cue_validity_label', 'post_event_pos_label'. You can override using the `.groups` argument."
"0","  # filter(post_hit == ""error"")"
"0","#mutate(time=factor(time, levels = c('pre', 'post'), ordered = T))"
"0",""
"0","## percent correct"
"0","#find ylims"
"0","temp_ylims <- dat_plot%>%"
"0","  ungroup()%>%"
"0","  summarise("
"0","    min = min(percent_correct) - (max(percent_correct)-min(percent_correct))*.04,"
"0","    max = max(percent_correct)+ (max(percent_correct)-min(percent_correct))*.04)"
"0",""
"0",""
"0","dat2plot <- dat_plot %>%"
"0","  filter(side=='left')"
"0",""
"0",""
"0","theme_set(theme_bw())"
"0","plot1 <- ggplot(dat2plot, aes(x=validity, y=percent_correct, fill=validity, color = validity)) +"
"0","  geom_line(aes(group = subject),alpha = 0.3, colour = ""grey60"") +"
"0","  geom_beeswarm(cex=1.5, size = 4, shape=21,alpha=1,fill=""grey40"",shape=21)+"
"0","  stat_summary(fun=mean, aes(ymin=..y.., ymax=..y.., color =validity), geom='errorbar', width=0.9, size=1.5) +"
"0","  # stat_summary(fun.data=mean_se, geom=""errorbar"", width=0.5,lwd=1)+"
"0","    # geom_boxplot(width=0.4, fill=""white"", alpha=0, lwd=1, color=""grey60"")+"
"0","  theme(legend.position=""none"")+"
"0","  # theme(legend.position=""bottom"")+"
"0","  scale_color_manual(values=c(""#F1831A"", ""#293C4A"", ""#198A83""))+"
"0","  scale_fill_manual(values=c(""#F1831A"", ""#293C4A"", ""#198A83""))+"
"0","  scale_y_continuous(limits=c(temp_ylims$min, temp_ylims$max))+"
"0","  xlab('left | validity')"
"0",""
"0","dat2plot <- dat_plot %>%"
"0","  filter(side=='right')"
"0",""
"0","plot2 <- ggplot(dat2plot, aes(x=validity, y=percent_correct, fill=validity, color = validity)) +"
"0","  geom_line(aes(group = subject),alpha = 0.3, colour = ""grey60"") +"
"0","  geom_beeswarm(cex=1.5, size = 4, shape=21,alpha=1,fill=""grey40"",shape=21)+"
"0","  stat_summary(fun=mean, aes(ymin=..y.., ymax=..y.., color =validity), geom='errorbar', width=0.9, size=1.5) +"
"0","  # stat_summary(fun.data=mean_se, geom=""errorbar"", width=0.5,lwd=1)+"
"0","    # geom_boxplot(width=0.4, fill=""white"", alpha=0, lwd=1, color=""grey60"")+"
"0","  theme(legend.position=""none"")+"
"0","  # theme(legend.position=""bottom"")+"
"0","  scale_color_manual(values=c(""#F1831A"", ""#293C4A"", ""#198A83""))+"
"0","  scale_fill_manual(values=c(""#F1831A"", ""#293C4A"", ""#198A83""))+"
"0","  scale_y_continuous(limits=c(temp_ylims$min, temp_ylims$max))+"
"0","  xlab('right | validity')"
"0",""
"0",""
"0","plot3 <- ggplot(dat_plot, aes(y = percent_correct, fill = validity, x = 1)) +"
"0","  geom_flat_violin(aes(x = side, fill = validity),"
"0","                   position = position_nudge(x = -.1, y = 0), "
"0","                   adjust = 1.3, trim = FALSE, alpha = 1, colour = NA)+"
"0","  # geom_hline(yintercept=0, show.legend = FALSE) +"
"0","  scale_color_manual(values=c(""#F1831A"", ""#293C4A"", ""#198A83""))+"
"0","  scale_fill_manual(values=c(""#F1831A"", ""#293C4A"", ""#198A83""))+"
"0","  theme(axis.title.y=element_blank(),"
"0","        axis.text.y=element_blank(),"
"0","        axis.ticks.y=element_blank())+"
"0","  theme(axis.title.x=element_blank(),"
"0","        axis.text.x=element_blank(),"
"0","        axis.ticks.x=element_blank())+"
"0","  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+"
"0","  # scale_y_continuous(limits=c(-60, 140))"
"0","  theme(legend.position=""none"")+"
"0","  scale_y_continuous(limits=c(temp_ylims$min, temp_ylims$max))"
"0",""
"0",""
"0",""
"0","# cowplot::plot_grid(plot1, plot2, plot3, ncol = 3,labels = ""AUTO"")"
"0","plotttitle <- ggdraw() + draw_label(""Correct responses in %"", fontface='bold')"
"0","plotplots <- ggarrange(plot1, plot2, plot3, ncol = 3,common.legend = TRUE,align = ""h"", widths=c(2,2,1))"
"0","ggarrange(plotttitle, plotplots, nrow = 2, heights=c(0.2, 1))"

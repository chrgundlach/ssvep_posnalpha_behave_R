"0",""
"0","# non-collapsed data"
"0","Data_Collapsed_t <- DataIn %>%"
"0","  dplyr::select(-amplitude_induced, -modulation_induced, -modulation_evoked,"
"0","                -RDK_id, -RDK_col, -RDK_pos, -RDK_col_pos, -RDK_freq,"
"0","                -con_col_attended, -con_pos_attended, -con_col_pos_attended)%>%"
"0","  pivot_wider(names_from = time, values_from = amplitude_evoked)%>%"
"0","  pivot_longer(c(-subjects, -con_RDK_attended, -con_RDK_col_attended, -con_RDK_pos_attended),"
"0","               names_to = ""time"", values_to = ""amplitude"")"
"0",""
"0",""
"0","#evoked baseline corrected for attended color####"
"0","dat2plot2 <- Data_Collapsed_t%>%"
"0","  filter(time==""[0.5 4]"")"
"0",""
"0","# for attended color  "
"0","### for saving with alpha = 1"
"0",""
"0","# set limits"
"0","yax_limits <- c( min(dat2plot2$amplitude), max(dat2plot2$amplitude))"
"0","yax_limits <- round(yax_limits + c(-1, 1)*diff(yax_limits)*0.1)"
"0",""
"0","# theme_set(theme_bw())"
"0","# ggplot(dat2plot2, aes(x = con_RDK_pos_attended, y = amplitude, fill = con_RDK_col_attended)) +"
"0","#   geom_hline(yintercept=0, show.legend = FALSE) +"
"0","#   geom_beeswarm(aes(color = con_RDK_col_attended, x = con_RDK_pos_attended), "
"0","#                 dodge.width = 0.8, cex=1.5, size = 3,alpha=1,fill=""grey40"",shape=21)+"
"0","#   # geom_point(aes(color = condition, x = interaction(time,condition),"
"0","#   #                   group = condition), size = 4,alpha=0.4)+"
"0","#   stat_summary(fun.y=mean, aes(ymin=..y.., ymax=..y.., color =con_RDK_col_attended), "
"0","#                geom='errorbar', width=0.9, size=1.5, position = position_dodge(0.8)) +"
"0","#   facet_grid(.~time)+"
"0","#   scale_x_discrete(""position"", breaks=waiver(), labels = c(""attended"",""unattended"")) +"
"0","#   # theme(legend.position=""bottom"") +"
"0","#   ylab(expression(paste(""amplitude in muV"")))+"
"0","#     scale_fill_manual(values=c( ""#193A3D"", ""#F03F3F""))+"
"0","#     scale_color_manual(values=c(""#193A3D"", ""#F03F3F""))+"
"0","#     theme(legend.position=""bottom"")"
"0","#   # scale_y_continuous(limits=c(-60, 140))"
"0","#   # scale_y_continuous(limits=yax_limits)"
"0",""
"0","theme_set(theme_bw())"
"0","plot1 <- ggplot(dat2plot2, aes(x = con_RDK_pos_attended, y = amplitude, fill = con_RDK_col_attended)) +"
"0","  geom_hline(yintercept=0, show.legend = FALSE) +"
"0","  geom_beeswarm(aes(color = interaction(con_RDK_col_attended,con_RDK_pos_attended), x = con_RDK_pos_attended), "
"0","                dodge.width = 0.8, cex=1.5, size = 3,alpha=1,fill=""grey40"",shape=21)+"
"0","  stat_summary(fun.y=mean, aes(ymin=..y.., ymax=..y.., color =interaction(con_RDK_col_attended,con_RDK_pos_attended)), "
"0","               geom='errorbar', width=0.9, size=1.5, position = position_dodge(0.8)) +"
"0","  scale_x_discrete(""position"", breaks=waiver(), labels = c(""attended"",""unattended"")) +"
"0","  # theme(legend.position=""bottom"") +"
"0","  ylab(expression(paste(""amplitude in muV"")))+"
"0","    scale_fill_manual(values=c(rgb2hex(255, 133, 4),rgb2hex(25, 138, 131),rgb2hex(255, 194, 64),rgb2hex(37, 207, 197)),"
"0","                      name = ""condition"", labels = c(""c+p+"",""c-p+"",""c+p-"",""c-p-""))+"
"0","    scale_color_manual(values=c(rgb2hex(255, 133, 4),rgb2hex(25, 138, 131),rgb2hex(255, 194, 64),rgb2hex(37, 207, 197)),"
"0","                       name = ""condition"", labels = c(""c+p+"",""c-p+"",""c+p-"",""c-p-""))+"
"0","    theme(legend.position=""bottom"")"
"0",""
"0","plotttitle <- ggdraw() + draw_label(""SSVEP modulation | subjects X RDKs | by condition X time"", fontface='bold')"
"0",""
"0","savefig <- multi_panel_figure(columns = 1, rows = 1, panel_label_type = ""none"", width = 4, height = 4, unit = ""in"")"
"0","saveplot <- ggarrange(plotttitle, plot1, nrow = 2, heights=c(0.2, 1))"
"0",""
"0","savefig %<>%"
"0","  fill_panel(saveplot, column = 1, row = 1)"
"0","savefig"
